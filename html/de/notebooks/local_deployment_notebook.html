<!DOCTYPE html>
<html class="writer-html5" lang="de" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Local Service Deployment - How to &mdash; Lomas 0.0.1 Dokumentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=a921576d"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=70a09b52"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="../genindex.html" />
    <link rel="search" title="Suche" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Lomas
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                develop
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Dokumentation durchsuchen" aria-label="Dokumentation durchsuchen" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Client</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../client_quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../client_errors.html">Errors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Server</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../server_deployment.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../server_administration.html">Administration</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API Documentation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../CONTRIBUTING.html">Tips for developers</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Lomas</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Local Service Deployment - How to</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/local_deployment_notebook.ipynb.txt" rel="nofollow"> Quelltext anzeigen</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Local-Service-Deployment---How-to">
<h1>Local Service Deployment - How to<a class="headerlink" href="#Local-Service-Deployment---How-to" title="Link to this heading"></a></h1>
<p>This notebook showcases how to set up the service, add and make data available to users in a local environment. In addition, it also shows how to set up a user session for testing.</p>
<p>We use docker and docker compose files to automate the local deployment.</p>
<section id="Docker-volume-and-config-setup">
<h2>Docker volume and config setup<a class="headerlink" href="#Docker-volume-and-config-setup" title="Link to this heading"></a></h2>
<p>The first step is to create a docker volume for mongodb, which will hold all the „admin“ data of the server. Docker volumes are persistent storage spaces that are managed by docker and can be mounted in containers. To create the volume, use</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">volume</span> <span class="pre">create</span> <span class="pre">mongodata</span></code></p>
<p>and you should see <code class="docutils literal notranslate"><span class="pre">mongodata</span></code> printed to the console. This must be done only once, and we use bind mounts for the server, so no need to create volumes for that.</p>
<p>Secondly, one must adapt the yaml config files in <code class="docutils literal notranslate"><span class="pre">server/configs/</span></code>. The default values should be enough to start a demo version of the service though. Keep in mind that certain parameter modification require to also update the docker compose files accordingly. This is out of scope for this notebook.</p>
</section>
<section id="Service-start">
<h2>Service start<a class="headerlink" href="#Service-start" title="Link to this heading"></a></h2>
<p>In <code class="docutils literal notranslate"><span class="pre">server/</span></code> you will find the <code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code> file that is used for deploying the service locally. In a terminal, <code class="docutils literal notranslate"><span class="pre">cd</span></code> into <code class="docutils literal notranslate"><span class="pre">server/</span></code>and run</p>
<p><code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">compose</span> <span class="pre">up</span></code></p>
<p>This will start the server, the mongodb as well as a user environment, each running in their own container. The first time this command is run, required containers images will automatically be built locally or downloaded from dockerhub, depending on the particular image. Note that container logs are all printed to your terminal.</p>
<p>To check that all containers are indeed running, run <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">ps</span></code>. You should be able to see a container for the server (<code class="docutils literal notranslate"><span class="pre">lomas_server_dev</span></code>), for the client (<code class="docutils literal notranslate"><span class="pre">lomas_client_dev</span></code>) and one for the mongo database (<code class="docutils literal notranslate"><span class="pre">mongodb</span></code>).</p>
</section>
<section id="Server-test">
<h2>Server test<a class="headerlink" href="#Server-test" title="Link to this heading"></a></h2>
<p>Appart from the logs in the console, we can also check the server state through our web browser. To get the server state, use the following url:</p>
<p><a class="reference external" href="http://127.0.0.1/state">http://127.0.0.1/state</a></p>
<p>If everything went well, the page should show a few messages and the state should be „LIVE“.</p>
<p>For exploring and testing API endpoints of the server, one can also use the automatically generated Swagger docummentation page with</p>
<p><a class="reference external" href="http://127.0.0.1/docs">http://127.0.0.1/docs</a></p>
</section>
<section id="User-session">
<h2>User session<a class="headerlink" href="#User-session" title="Link to this heading"></a></h2>
<p>Now that we know the server is in „LIVE“ state, one can run one of our client demo notebooks from the user session. The default configuration starts a JupyterLab server at</p>
<p><a class="reference external" href="http://127.0.0.1:8.8.8.8/">http://127.0.0.1:8.8.8.8/</a></p>
<p>and the default password for that is „dprocks“. The root directory of the client session gives access to all the client demo notebooks, follow them for more!</p>
<p>For starting user sessions alone, there is an alternative <code class="docutils literal notranslate"><span class="pre">docker-compose.yml</span></code> file in the <code class="docutils literal notranslate"><span class="pre">client</span></code> directory of this repository. The configuration files for the user session are located in <code class="docutils literal notranslate"><span class="pre">client/configs</span></code>, regardless of the chosen docker compose file.</p>
</section>
<section id="Service-stop">
<h2>Service stop<a class="headerlink" href="#Service-stop" title="Link to this heading"></a></h2>
<p>For stopping the service, simply run</p>
<p><code class="docutils literal notranslate"><span class="pre">CTRL</span> <span class="pre">+</span> <span class="pre">c</span></code> and then <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">compose</span> <span class="pre">down</span></code></p>
<p>in your terminal. This will stop and remove all the service containers. Note that the mongodb volume will persist and must not be recreate on subsequent startups of the service.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, DSCC.</p>
  </div>

  Erstellt mit <a href="https://www.sphinx-doc.org/">Sphinx</a> mit einem
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    bereitgestellt von <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      Version: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      
      <dl>
        <dt>Languages</dt>
          
            <dd><a href="https://dscc-admin-ch.github.io/lomas-docs//index.html">en</a></dd>
          
      </dl>
      
      
      <dl>
        <dt>Versionen</dt>
        
          <dd><a href="https://dscc-admin-ch.github.io/lomas-docs//master/de/index.html">master</a></dd>
        
          <dd><a href="https://dscc-admin-ch.github.io/lomas-docs//develop/de/index.html">develop</a></dd>
        
      </dl>
      
      <br>
      </dl>
    </div>
  </div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>